{% extends "form_simp_base.html" %}
{% block content %}

{% include "form_autosave.html" %}

<!--
<a class="btn btn-secondary" href="/course/{{ course.id }}/">Return to the Course Homepage</a>
-->

<div class="container-fluid">

  <div class="col-md-10 col-md-offset-2">

    <h2 class="page-header">Edit the Course <!--{{ course.displayname }}--></h2>

    <form id="courseForm" method='post' action="/course/{{ course.id }}/edit/">
      {% csrf_token %}

      {% for field in formCourse %}
      <div class="form-group row">
        <div class="col-md-4 col-form-label">
          {{ field.label_tag }}
        </div>
        <div class="col-md-4">
          {{ field }}
        </div>
      </div>
      {% endfor %}

      <input type="submit" class="btn btn-primary" value="Update Configuration">

    </form>

    <script>$(document).ready(function () {
          var typingTimer;
          var doneTypingInterval = 500;

          $('#courseForm').find(':input').on('input', function () {
              clearTimeout(typingTimer);
              typingTimer = setTimeout(function () {
                  autosave();
              }, doneTypingInterval);
          });

          function autosave() {
            $.ajax({
                  type: 'POST',
                  data: $('#courseForm').serialize(),
                  url: '/course/{{ course.id }}/edit/',
                  success: function (data) {
                      showFormSaveOverlay();
                  },
                  error: function (error) {
                      console.log('Save error: ', error);
                  },
              });
          }
      });

    </script>

    <div class="btn-group" role="group" aria-label="...">
      {% if course.browsable %}
      <a class="btn btn-default" href="/course/{{ course.id }}/modify/?action=hide">Hide the course</a>
      {% else %}
      <a class="btn btn-success" href="/course/{{ course.id }}/modify/?action=show">Show the course</a>
      {% endif %}
    </div>

  </div>
</div>

{% endblock %}